<div class='card'>
  <div class='row banner'>
    <div class='col-md-7'>
      <h1>
        <i class="fas fa-user-astronaut"></i>
        <%= @user.nickname %>'s Profile
      </h1>
    </div>
    <div class='col-md-5'>
      <h1><%= LeaderboardHelper.find_user_position(@user) %></h1>
    </div>
  </div>
  <div class='card-body'>
    <div class='row'>
      <div class='col-md-6'>
        <h2>Total Donations: <%= @user.donations.count %></h2>
        <h2>Total Amount Donated: <%= MoneyHelper.format_amount(@user.total_donated_amount) %></h2>
      </div>
      <% if @user.monthly_goal %>
        <div class='col-md-5'>
          <h2>Monthly Goal: <%= MoneyHelper.format_amount(@user.monthly_goal) %></h2>
          <% unless @user.monthly_goal_met? %>
            <h3>
              <% if @user == current_user %>
                You have <%= pluralize(Time.now.end_of_month.day - Time.now.day, 'day') %> left to meet your goal
              <% else %>
                <%= @user.nickname %> has <%= pluralize(Time.now.end_of_month.day - Time.now.day, 'day') %> left to meet their goal
              <% end %>
            </h3>
          <% else %>
            <% if @user == current_user %>
              You met your goal! 
            <% else %>
              <%= @user.nickname %> met their goal!
            <% end %>
          <% end %>
        </div>
        <div class='col-md-1'>
          <div id='thermometer' style='background: <%= MoneyHelper.thermometer(@user) %>;'></div>
        </div>
      <% else %>
        <div class='col-md-6'>
          <%= @user == current_user ? "#{@user.nickname} hasn't" : "You haven't" %> hasn't set a monthly goal yet.
        </div>
      <% end %>
    </div>

    <% if @user == current_user %>
      <br>
      <div class='private'>
        <p class='text-muted'>(This is only visible to you)</p>
        <table class='table'>
          <thead>
            <th>Organization</th>
            <th>Amount</th>
            <th>Date</th>
            <th></th>
          </thead>
          <tbody>
            <% if @user.donations.any? %>
              <% @user.donations.each do |donation| %>
                <tr>
                  <td><%= link_to donation.pledgeling_organization_name, organization_path(donation.pledgeling_organization_id) %></td>
                  <td><%= MoneyHelper.format_amount(donation.amount) %></td>
                  <td><%= donation.created_at.to_date %></td>
                  <% if donation.created_at.today? %>
                    <td>
                      <a  class="btn btn-primary btn-sm"
                          style='background-color: #1b95e0;'
                          href="<%= SocialHelper.tweet_button_url(donation) %>"
                          target="_blank"
                        >
                        <i class="fab fa-twitter"></i> Tweet
                      </a>
                    </td>
                  <% end %>
                </tr>
              <% end %>
            <% else %>
              <tr><td class='text-muted'>You haven't made any donations yet.</td></tr>
            <% end %>
          </tbody>
        </table>
      </div>
    <% end %>
    
  </div>
</div>
